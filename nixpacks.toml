# Nixpacks configuration for Railway deployment
# better-sqlite3 requires native compilation tools and Node 20+

providers = ["node"]

[variables]
NIXPACKS_NODE_VERSION = "20"

[phases.setup]
nixPkgs = ["...", "python311"]
aptPkgs = ["build-essential", "python3"]

[phases.build]
cmds = [
  "cd frontend && npm install && npm run build",
  "cd backend && npm install"
]

[start]
cmd = "cd backend && NODE_ENV=production node server.js"
